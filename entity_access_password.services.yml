services:
  cache_context.entity_access_password_entity_is_protected:
    class: Drupal\entity_access_password\Cache\Context\EntityIsProtectedCacheContext
    arguments:
      - '@entity_type.manager'
      - '@entity_access_password.password_access_manager'
    tags:
      - { name: cache.context }

  entity_access_password.password_validator:
    class: Drupal\entity_access_password\Service\PasswordValidator
    arguments:
      - '@config.factory'
      - '@password'
      - '@entity_access_password.access_storage_manager'

  entity_access_password.access_storage_manager:
    class: Drupal\entity_access_password\Service\AccessStorageManager
    tags:
      - { name: 'service_collector', tag: 'entity_access_password_access_storage', call: 'addStorage' }

  entity_access_password.access_checker_manager:
    class: Drupal\entity_access_password\Service\AccessCheckerManager
    tags:
      - { name: 'service_collector', tag: 'entity_access_password_access_checker', call: 'addChecker' }

  entity_access_password.password_access_manager:
    class: Drupal\entity_access_password\Service\PasswordAccessManager
    arguments:
      - '@entity_access_password.access_checker_manager'

  entity_access_password.bypass_permission_checker:
    class: Drupal\entity_access_password\Service\BypassPermissionAccessChecker
    arguments:
      - '@current_user'
    tags:
      - { name: 'entity_access_password_access_checker', priority: 200 }
